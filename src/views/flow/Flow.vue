<template>
  <div class="flow">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <NavBar />

    <div class="flow-container">
      <div class="flow-header">
        <h1>Flow</h1>
        <p class="subtitle">å®æ—¶æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·ï¼ŒåŸºäº Socket.IO å®ç°</p>
        <div class="online-count">
          <el-tag type="success" size="large"> å½“å‰åœ¨çº¿: {{ onlineUsers.length }} äºº </el-tag>
        </div>
      </div>

      <!-- åœ¨çº¿ç”¨æˆ·åˆ—è¡¨ -->
      <div class="user-list" v-if="onlineUsers.length > 0">
        <OnlineUserCard v-for="user in onlineUsers" :key="user.userId" :user="user" />
      </div>

      <!-- æš‚æ— åœ¨çº¿ç”¨æˆ· -->
      <div class="empty-state" v-else>
        <el-empty description="æš‚æ— åœ¨çº¿ç”¨æˆ·">
          <template #image>
            <div class="empty-icon">ğŸ‘¥</div>
          </template>
        </el-empty>
      </div>
    </div>
  </div>
</template>

<script lang="ts" setup>
import NavBar from '@/components/navbar/NavBar.vue';
import OnlineUserCard from '@/components/OnlineUserCard.vue';
import useUserStore from '@/stores/user.store';

const userStore = useUserStore();
const { onlineUsers } = storeToRefs(userStore);

/**
 * Flowé¡µé¢ - åœ¨çº¿ç”¨æˆ·å±•ç¤º
 *
 * èŒè´£ï¼š
 * - å±•ç¤ºåœ¨çº¿ç”¨æˆ·åˆ—è¡¨ï¼ˆæ•°æ®æ¥è‡ª userStore.onlineUsersï¼‰
 * - ä¸å†è´Ÿè´£ç®¡ç†è¿æ¥ï¼ˆè¿æ¥ç®¡ç†å·²ç§»è‡³ App.vueï¼‰
 *
 * è¯´æ˜ï¼š
 * - åœ¨çº¿çŠ¶æ€ç”± App.vue å…¨å±€ç®¡ç†
 * - æ­¤é¡µé¢åªè´Ÿè´£å±•ç¤ºæ•°æ®
 * - Socket è¿æ¥åœ¨ç™»å½•åè‡ªåŠ¨å»ºç«‹ï¼Œä¸ä¾èµ–ç”¨æˆ·æ˜¯å¦è®¿é—®"Flow"é¡µé¢
 */
</script>

<style lang="scss" scoped>
.flow {
  .flow-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 40px 20px;

    .flow-header {
      text-align: center;
      margin-bottom: 40px;

      h1 {
        font-size: 36px;
        font-weight: bold;
        margin: 0 0 16px 0;
      }

      .subtitle {
        font-size: 16px;
        color: #666;
        margin: 0 0 20px 0;
      }

      .online-count {
        display: inline-block;
      }
    }

    .user-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0; // é€šè¿‡å¡ç‰‡è‡ªèº«çš„ margin æ§åˆ¶é—´è·
    }

    .empty-state {
      padding: 60px 0;

      .empty-icon {
        font-size: 80px;
        margin-bottom: 20px;
      }
    }
  }
}
</style>
